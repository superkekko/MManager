ALTER TABLE user ADD COLUMN color VARCHAR(6) NOT NULL DEFAULT '000000' AFTER valid;
CREATE OR REPLACE VIEW tot_usr AS select abs(sum(m.val)) AS val, m.usr_mov AS usr_mov, u.color as usr_color, c.income AS income, year(m.dat_mov) AS year from movement m join category c ON c.cat_id = m.cat_id join user u on u.usr_id= m.usr_mov group by m.usr_mov , u.color, c.income , year(m.dat_mov);
CREATE OR REPLACE VIEW tot_eu AS select t.month AS month, t.year AS year, sum(t.income) AS income, (-(1) * sum(t.outcome)) AS outcome from tot_eu_month_tmp t group by t.month, t.year UNION select '1', 0, 0, 0 from dual UNION select '2', 0, 0, 0 from dual UNION select '3', 0, 0, 0 from dual UNION select '4', 0, 0, 0 from dual UNION select '5', 0, 0, 0 from dual UNION select '6', 0, 0, 0 from dual UNION select '7', 0, 0, 0 from dual UNION select '8', 0, 0, 0 from dual UNION select '9', 0, 0, 0 from dual UNION select '10', 0, 0, 0 from dual UNION select '11', 0, 0, 0 from dual UNION select '12', 0, 0, 0 from dual;
insert into mversion (db) values ('1.3');