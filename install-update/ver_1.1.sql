CREATE OR REPLACE VIEW tot_cat AS select sum(m.val) AS val, c.cat_name AS cat_name, c.color, c.cat_id AS cat_id, c.income AS income, year(m.dat_mov) AS year from (movement m join category c) where (m.cat_id = c.cat_id) group by c.cat_name , c.cat_id , c.income , year(m.dat_mov);
CREATE OR REPLACE VIEW tot_cat_date AS select sum(m.val) AS val, c.cat_name AS cat_name, c.cat_id AS cat_id, c.color, c.income AS income, month(m.dat_mov) AS month, year(m.dat_mov) AS year from (movement m join category c) where (m.cat_id = c.cat_id) group by c.cat_name , c.cat_id , c.color, c.income , month(m.dat_mov) , year(m.dat_mov) union select 0 AS '0', category.cat_name AS cat_name, category.cat_id AS cat_id, category.color, category.income AS income, 1 AS '1', 0 AS '0' from category union select 0 AS '0', category.cat_name AS cat_name, category.cat_id AS cat_id, category.color, category.income AS income, 2 AS '2', 0 AS '0' from category union select 0 AS '0', category.cat_name AS cat_name, category.cat_id AS cat_id, category.color, category.income AS income, 3 AS '3', 0 AS '0' from category union select 0 AS '0', category.cat_name AS cat_name, category.cat_id AS cat_id, category.color, category.income AS income, 4 AS '4', 0 AS '0' from category union select 0 AS '0', category.cat_name AS cat_name, category.cat_id AS cat_id, category.color, category.income AS income, 5 AS '5', 0 AS '0' from category union select 0 AS '0', category.cat_name AS cat_name, category.cat_id AS cat_id, category.color, category.income AS income, 6 AS '6', 0 AS '0' from category union select 0 AS '0', category.cat_name AS cat_name, category.cat_id AS cat_id, category.color, category.income AS income, 7 AS '7', 0 AS '0' from category union select 0 AS '0', category.cat_name AS cat_name, category.cat_id AS cat_id, category.color, category.income AS income, 8 AS '8', 0 AS '0' from category union select 0 AS '0', category.cat_name AS cat_name, category.cat_id AS cat_id, category.color, category.income AS income, 9 AS '9', 0 AS '0' from category union select 0 AS '0', category.cat_name AS cat_name, category.cat_id AS cat_id, category.color, category.income AS income, 10 AS '10', 0 AS '0' from category union select 0 AS '0', category.cat_name AS cat_name, category.cat_id AS cat_id, category.color, category.income AS income, 11 AS '11', 0 AS '0' from category union select 0 AS '0', category.cat_name AS cat_name, category.cat_id AS cat_id, category.color, category.income AS income, 12 AS '12', 0 AS '0' from category;
ALTER TABLE mversion DROP COLUMN web;
insert into mversion (db) values ('1.1');